(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{59:function(e,t,n){},60:function(e,t,n){"use strict";n.r(t);var r,c,a,i,o,s,l=n(0),u=n(30),d=n.n(u),b=n(20),h=n(4),p=n(16),j=n(5),f=n(39),O="@media (max-width: 991px)",v=n(25),m=n(1),x=p.a.div(r||(r=Object(h.a)(["\n  display: flex;\n  flex-direction: column;\n"]))),g=p.a.input({borderRadius:"3px",border:"1px solid #f1f1f4",background:"#f1f2f7",padding:"8px 12px"}),w=p.a.button(i||(i=Object(h.a)(["\n  padding: 10px 15px;\n  border: 0;\n  line-height: 1;\n  border-radius: 3px;\n  ","\n"])),(function(e){switch(e.variant){case"primary":return Object(j.a)(c||(c=Object(h.a)(["\n        background: #3f51b5;\n        color: white;\n      "])));case"secondary":return Object(j.a)(a||(a=Object(h.a)(["\n        background: #f1f2f7;\n        color: #434449;\n      "])))}})),y=p.a.button({borderRadius:"30px",padding:"0",width:"40px",height:"40px",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center",background:"white",color:"#434449",border:"1px solid #f1f1f4",cursor:"pointer"}),k=Object(p.a)(f.a)(Object(b.a)({maxWidth:"450px",borderRadius:"3px",paddingBottom:"3.5em",boxShadow:"0 10px 30px -5px rgba(0, 0, 0, 0.2)",margin:"20vh auto"},O,{width:"100%",margin:"10vh auto"})),C=Object(j.b)(o||(o=Object(h.a)(["\n  0% {\n    transform: rotate(0deg)\n  }\n  100% {\n    transform: rotate(360deg)\n  }\n"]))),S=Object(p.a)(v.b)(s||(s=Object(h.a)(["\n  animation: "," 1s linear infinite;\n"])),C);function F(){return Object(m.a)("div",{css:{fontSize:"4em",height:"100vh",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:Object(m.a)(S,{})})}var E=p.a.ul({listStyle:"none",padding:"0",display:"grid",gridTemplateRows:"repeat(auto-fill, minmax(100px, 1fr))",gridGap:"1em"}),z=n(7),T=n.n(z),B=n(6),I=n(14),L="__auth_provider_token__";function M(){return R.apply(this,arguments)}function R(){return(R=Object(I.a)(T.a.mark((function e(){return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",window.localStorage.getItem(L));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e){return window.localStorage.setItem(L,e.token),e}function P(){return A.apply(this,arguments)}function A(){return(A=Object(I.a)(T.a.mark((function e(){return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.localStorage.removeItem(L);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var H="https://cyh-bookshelf.herokuapp.com";function _(e,t){return V.apply(this,arguments)}function V(){return(V=Object(I.a)(T.a.mark((function e(t,n){var r;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}},e.abrupt("return",window.fetch("".concat(H,"/").concat(t),r).then(function(){var e=Object(I.a)(T.a.mark((function e(t){var n;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:if(n=e.sent,t.ok){e.next=5;break}return e.abrupt("return",Promise.reject(n.message));case 5:return e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var N=n(13);var G={status:"idle",data:null,error:null};function J(e){var t=l.useRef(Object(B.a)(Object(B.a)({},G),e)),n=l.useReducer((function(e,t){return Object(B.a)(Object(B.a)({},e),t)}),t.current),r=Object(N.a)(n,2),c=r[0],a=c.data,i=c.error,o=c.status,s=function(e){var t=l.useRef(!1);return l.useLayoutEffect((function(){return t.current=!0,function(){return t.current=!1}}),[]),l.useCallback((function(){return t.current?e.apply(void 0,arguments):void 0}),[e])}(r[1]),u=l.useCallback((function(e){return s({data:e,status:"resolved"})}),[s]),d=l.useCallback((function(e){return s({error:e,status:"rejected"})}),[s]),b=l.useCallback((function(){return s(t.current)}),[s]),h=l.useCallback((function(e){if(!e||!e.then)throw new Error("The argument passed to useAsync().run must be a promise. Maybe a function that's passed isn't returning anything?");return s({status:"pending"}),e.then((function(e){return u(e),e}),(function(e){return d(e),Promise.reject(e)}))}),[s,u,d]);return{isIdle:"idle"===o,isLoading:"pending"===o,isError:"rejected"===o,isSuccess:"resolved"===o,error:i,status:o,data:a,setData:u,setError:d,run:h,reset:b}}var U="#ef5350",q=n(2),W=l.createContext();function K(){return(K=Object(I.a)(T.a.mark((function e(){var t,n;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=null,e.next=3,M();case 3:if(!(n=e.sent)){e.next=8;break}return e.next=7,_("me",{token:n});case 7:t=e.sent;case 8:return e.abrupt("return",t);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Q(e){var t=J(),n=t.data,r=t.error,c=t.isLoading,a=t.isIdle,i=t.isError,o=t.isSuccess,s=t.run,u=t.setData;l.useEffect((function(){s(function(){return K.apply(this,arguments)}())}),[s]);var d=l.useCallback((function(e){return(t=e,_("login",{username:t.username,password:t.password}).then(D)).then((function(e){return u(e)}));var t}),[u]),b=l.useCallback((function(e){return(t=e,_("register",{username:t.username,password:t.password}).then(D)).then((function(e){return u(e)}));var t}),[u]),h=l.useCallback((function(){P(),u(null)}),[u]),p=l.useMemo((function(){return{user:n,login:d,logout:h,register:b}}),[d,h,b,n]);return c||a?Object(q.jsx)(F,{}):i?Object(q.jsxs)("div",{css:{color:U,height:"100vh",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[Object(q.jsx)("p",{children:"Uh oh... There's a problem. Try refreshing the app."}),Object(q.jsx)("pre",{children:r})]}):o?Object(q.jsx)(W.Provider,Object(B.a)({value:p},e)):void 0}function X(){return l.useContext(W)}function Y(e){var t=e.book,n=t.title,r=t.author,c=t.coverImageUrl,a="book-row-book-".concat(t.id);return Object(m.a)("div",{css:{display:"flex",alignItems:"center",justifyContent:"flex-end",position:"relative"},children:Object(m.b)("div",{"aria-labelledby":a,css:{minHeight:270,flexGrow:2,display:"grid",gridTemplateColumns:"140px 1fr",gridGap:20,border:"1px solid ".concat("#e4e5e9"),color:"#434449",padding:"1.25em",borderRadius:"3px",":hover,:focus":{textDecoration:"none",boxShadow:"0 5px 15px -5px rgba(0,0,0,.08)",color:"inherit"}},children:[Object(m.a)("div",{css:Object(b.a)({width:140},O,{width:100}),children:Object(m.a)("img",{src:c,alt:"".concat(n," book cover"),css:{maxHeight:"100%",width:"100%"}})}),Object(m.b)("div",{css:{flex:1},children:[Object(m.b)("div",{css:{display:"flex",justifyContent:"space-between"},children:[Object(m.a)("div",{css:{flex:1},children:Object(m.a)("h2",{id:a,css:{fontSize:"1.25em",margin:"0",color:"#3f51b5"},children:n})}),Object(m.b)("div",{css:{marginLeft:10},children:[Object(m.a)("div",{css:{marginTop:"0.4em",fontStyle:"italic",fontSize:"0.85em"},children:r}),Object(m.a)("small",{children:t.publisher})]})]}),Object(m.b)("small",{css:{whiteSpace:"break-spaces",display:"block"},children:[t.synopsis.substring(0,500),"..."]})]})]})})}W.displayName="AuthContext";var Z=n(26),$="https://cyh-bookshelf.herokuapp.com/api";var ee,te,ne,re,ce=n(40);function ae(){var e=X().user,t=J(),n=t.data,r=t.run,c=t.error,a=t.isLoading,i=t.isError,o=t.isSuccess,s=Object(l.useState)(""),u=Object(N.a)(s,2),d=u[0],b=u[1],p=Object(l.useState)(!1),f=Object(N.a)(p,2),O=f[0],x=f[1];return Object(l.useEffect)((function(){O&&r(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.data,r=t.token,c=t.headers,a=Object(Z.a)(t,["data","token","headers"]),i=Object(B.a)({method:n?"POST":"GET",body:n?JSON.stringify(n):void 0,headers:Object(B.a)({Authorization:r?"Bearer ".concat(r):void 0,"Content-Type":n?"application/json":void 0},c)},a);return window.fetch("".concat($,"/").concat(e),i).then(function(){var e=Object(I.a)(T.a.mark((function e(t){var n;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(401!==t.status){e.next=4;break}return P(),window.location.assign(window.location),e.abrupt("return",Promise.reject({message:"Please re-authenticate."}));case 4:return e.next=6,t.json();case 6:if(n=e.sent,!t.ok){e.next=11;break}return e.abrupt("return",n);case 11:return e.abrupt("return",Promise.reject(n.message));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}("books?query=".concat(encodeURIComponent(d)),{token:e.token}))}),[O,d,r,e.token]),Object(m.b)("div",{css:Object(j.a)(ee||(ee=Object(h.a)(["\n        width: 90vw;\n        max-width: 800px;\n        padding: 40px 0;\n        margin: auto;\n      "]))),children:[Object(m.b)("form",{onSubmit:function(e){var t,n;e.preventDefault();var r=null===(t=e.target.elements)||void 0===t||null===(n=t.search)||void 0===n?void 0:n.value;x(!0),b(r)},css:Object(j.a)(te||(te=Object(h.a)(["\n          margin-bottom: 30px;\n        "]))),children:[Object(m.a)(g,{placeholder:"search books...",id:"search",css:Object(j.a)(ne||(ne=Object(h.a)(["\n            width: 100%;\n          "])))}),Object(m.a)(ce.a,{label:"Search Books",children:Object(m.a)("label",{htmlFor:"search",children:Object(m.a)("button",{type:"submit",css:Object(j.a)(re||(re=Object(h.a)(["\n                border: 0;\n                position: relative;\n                margin-left: -35px;\n                background: transparent;\n              "]))),children:a?Object(m.a)(S,{}):i?Object(m.a)(v.c,{css:{color:U}}):Object(m.a)(v.a,{})})})})]}),i?Object(m.b)("div",{css:{color:U},children:[Object(m.a)("p",{children:"There was an error:"}),Object(m.a)("pre",{children:c.message})]}):null,o?(null===n||void 0===n?void 0:n.length)?Object(m.a)(E,{css:{marginTop:20},children:n.map((function(e){return Object(m.a)("li",{children:Object(m.a)(Y,{book:e},e._id)},e._id)}))}):Object(m.a)("p",{children:"No books found. Try another search."}):null]})}function ie(){var e=X(),t=e.user,n=e.logout;return Object(m.b)("div",{children:[Object(m.b)("div",{css:{display:"flex",alignItems:"center",position:"absolute",top:"10px",right:"10px"},children:[t.username,Object(m.a)(w,{variant:"secondary",css:{marginLeft:"10px"},onClick:n,children:"Logout"})]}),Object(m.a)(ae,{})]})}var oe,se,le,ue,de,be=n(41),he=function(e){var t=e.width,n=void 0===t?"48":t,r=e.height,c=void 0===r?"48":r;return Object(q.jsxs)("svg",{width:"".concat(n,"px"),height:"".concat(c,"px"),viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",children:[Object(q.jsx)("title",{children:"Bookshelf"}),Object(q.jsxs)("g",{children:[Object(q.jsx)("path",{d:"M12,5H2C1.44772,5,1,5.44772,1,6v27h12V6C13,5.44772,12.55229,5,12,5z",fill:"#E86C60"}),Object(q.jsx)("path",{d:"M12,43H2c-0.55228,0-1-0.44772-1-1V32h12v10C13,42.55228,12.55229,43,12,43z",fill:"#444444"}),Object(q.jsx)("path",{d:"M8,23H6c-0.55228,0-1-0.44772-1-1V11c0-0.55229,0.44772-1,1-1h2c0.55229,0,1,0.44771,1,1v11 C9,22.55228,8.55229,23,8,23z",fill:"#FFFFFF"}),Object(q.jsx)("path",{d:"M35.44301,3.67613l-9.68988,2.47109c-0.53516,0.13647-0.85835,0.68094-0.72188,1.2161l6.67194,26.16267 l11.62785-2.96531L36.6591,4.398C36.52263,3.86285,35.97816,3.53965,35.44301,3.67613z",fill:"#43A6DD"}),Object(q.jsx)("path",{d:"M44.83315,40.49766l-9.68988,2.47109c-0.53516,0.13647-1.07962-0.18672-1.21609-0.72188l-2.47109-9.68988 l11.62785-2.96531l2.47109,9.68987C45.69151,39.81672,45.36831,40.36118,44.83315,40.49766z",fill:"#444444"}),Object(q.jsx)("path",{d:"M36.01502,22.10634l-1.93797,0.49422c-0.53516,0.13647-1.07962-0.18672-1.2161-0.72188l-2.7182-10.65886 c-0.13647-0.53516,0.18672-1.07962,0.72188-1.2161L32.8026,9.5095c0.53516-0.13647,1.07962,0.18672,1.2161,0.72188l2.7182,10.65886 C36.87337,21.4254,36.55017,21.96987,36.01502,22.10634z",fill:"#FFFFFF"}),Object(q.jsx)("path",{d:"M24,5H14c-0.55229,0-1,0.44772-1,1v27h12V6C25,5.44772,24.55228,5,24,5z",fill:"#E6E6E6"}),Object(q.jsx)("path",{d:"M24,43H14c-0.55229,0-1-0.44772-1-1V32h12v10C25,42.55228,24.55228,43,24,43z",fill:"#B3B3B3"}),Object(q.jsx)("path",{d:"M20,23h-2c-0.55228,0-1-0.44772-1-1V11c0-0.55229,0.44772-1,1-1h2c0.55228,0,1,0.44771,1,1v11 C21,22.55228,20.55228,23,20,23z",fill:"#FFFFFF"})]})]})},pe=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.forEach((function(e){return e&&e.apply(void 0,n)}))}},je=Object(l.createContext)();function fe(e){var t=e.children,n=Object(Z.a)(e,["children"]),r=Object(l.useState)(!1),c=Object(N.a)(r,2),a=c[0],i=c[1];return Object(m.a)(je.Provider,Object(B.a)(Object(B.a)({value:[a,i]},n),{},{children:t}))}function Oe(e){var t=e.children,n=Object(l.useContext)(je),r=Object(N.a)(n,2)[1];return Object(l.cloneElement)(t,{onClick:pe((function(){return r(!1)}),t.props.onClick)})}function ve(e){var t=e.children,n=Object(l.useContext)(je),r=Object(N.a)(n,2)[1];return Object(l.cloneElement)(t,{onClick:pe((function(){return r(!0)}),t.props.onClick)})}function me(e){var t=Object(l.useContext)(je),n=Object(N.a)(t,2),r=n[0],c=n[1];return Object(m.a)(k,Object(B.a)({isOpen:r,onDismiss:function(){return c(!1)}},e))}function xe(e){var t=e.title,n=e.children,r=Object(Z.a)(e,["title","children"]);return Object(m.b)(me,Object(B.a)(Object(B.a)({},r),{},{children:[Object(m.a)("div",{css:Object(j.a)(oe||(oe=Object(h.a)(["\n          display: flex;\n          justify-content: flex-end;\n        "]))),children:Object(m.a)(Oe,{children:Object(m.a)(y,{children:"x"})})}),Object(m.a)("h3",{css:Object(j.a)(se||(se=Object(h.a)(["\n          text-align: center;\n          font-size: 2em;\n        "]))),children:t}),n]}))}function ge(e){var t=e.onSubmit,n=e.submitButton,r=J(),c=r.isLoading,a=r.isError,i=r.error,o=r.run,s=function(e){var n,r,c,a;e.preventDefault();var i=null===(n=e.target.elements)||void 0===n||null===(r=n.username)||void 0===r?void 0:r.value,s=null===(c=e.target.elements)||void 0===c||null===(a=c.password)||void 0===a?void 0:a.value;o(t({username:i,password:s}))};return Object(m.b)("form",{onSubmit:function(e){return s(e)},css:Object(j.a)(le||(le=Object(h.a)(["\n        display: flex;\n        flex-direction: column;\n        align-items: stretch;\n        > div {\n          margin: 10px auto;\n          width: 100%;\n          max-width: 300px;\n        }\n      "]))),children:[Object(m.b)(x,{children:[Object(m.a)("label",{htmlFor:"username",children:"username"}),Object(m.a)(g,{type:"text",id:"username"})]}),Object(m.b)(x,{children:[Object(m.a)("label",{htmlFor:"password",children:"password"}),Object(m.a)(g,{type:"text",id:"password"})]}),Object(m.a)("div",{children:l.cloneElement.apply(void 0,[n,{type:"primary"}].concat(Object(be.a)(Array.isArray(n.props.children)?n.props.children:[n.props.children]),[c?Object(m.a)(S,{css:{marginLeft:5}}):null]))}),a?Object(m.a)("div",{css:{color:U},children:i}):null]})}function we(){var e=X(),t=e.login,n=e.register;return Object(m.b)("div",{css:Object(j.a)(ue||(ue=Object(h.a)(["\n        height: 100vh;\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        justify-content: center;\n        gap: 10px 0;\n      "]))),children:[Object(m.a)(he,{width:"80",height:"80"}),Object(m.a)("h1",{children:"Bookshelf"}),Object(m.b)("div",{css:Object(j.a)(de||(de=Object(h.a)(["\n          & > button {\n            margin: 0 6px;\n          }\n        "]))),children:[Object(m.b)(fe,{children:[Object(m.a)(ve,{children:Object(m.a)(w,{variant:"primary",children:"Login"})}),Object(m.a)(xe,{title:"Login","aria-label":"login",children:Object(m.a)(ge,{onSubmit:t,submitButton:Object(m.a)(w,{variant:"primary",children:"login"})})})]}),Object(m.b)(fe,{children:[Object(m.a)(ve,{children:Object(m.a)(w,{variant:"secondary",children:"Register"})}),Object(m.a)(xe,{title:"Register","aria-label":"register",children:Object(m.a)(ge,{submitButton:Object(m.a)(w,{variant:"secondary",children:"register"}),onSubmit:n})})]})]})]})}function ye(){return X().user?Object(q.jsx)(ie,{}):Object(q.jsx)(we,{})}function ke(e){var t=e.children;return Object(q.jsx)(Q,{children:t})}je.displayName="ModalContext";n(56),n(57),n(58),n(59);var Ce=document.getElementById("root");d.a.render(Object(q.jsx)(ke,{children:Object(q.jsx)(ye,{})}),Ce)}},[[60,1,2]]]);
//# sourceMappingURL=main.ff5c0d28.chunk.js.map